def getBintrayUserIdAndApiKey() {

    if (System.getenv("GITHUB_ACTIONS") != null) {
        def user = System.getenv("BINTRAY_USER")
        def key = System.getenv("BINTRAY_API_KEY")
        return [user, key]
    }

    Properties properties = new Properties()
    properties.load(project.rootProject.file('local.properties').newDataInputStream())

    def user = properties.getProperty("bintray.user")
    def key = properties.getProperty("bintray.apikey")

    if (user == null || user.isEmpty() ||
            key == null || key.isEmpty()) {
        throw new IllegalStateException("Must specify Bintray user/API key in your local.properties.")
    }

    return [user, key]
}

if (versions == null || versions.publishVersion == null) {
    throw new IllegalStateException("Unable to reference publishVersion")
}

ext {
    getBintrayUserIdAndApiKey = this.&getBintrayUserIdAndApiKey
}
